# Development Plan — v0.3

In-progress milestones for kiso v0.3. Continues from v0.2 (all M44–M67 complete).

## Principles

- **Agile**: smallest testable increment first, then layer on
- **No dead code**: every line written is immediately reachable and testable
- **Fail loud**: missing config, broken provider, invalid input → clear error, never silent fallback
- **Tested**: every milestone adds tests. `uv run pytest` must pass before moving on.

---

## Milestone 68: `version` — show total LOC inline

**Problem**: `kiso version` prints only `kiso 0.2.0`. The LOC count is hidden behind `kiso version --stats`, a flag most users will never discover. The total line count is a useful at-a-glance metric that costs nothing to compute and signals project size immediately.

**Fix**: plain `kiso version` (no flags) appends the total LOC on the same line:

```
kiso 0.2.0  (3 456 loc)
```

`kiso version --stats` keeps the full per-area breakdown unchanged. `count_loc` is already implemented in `kiso/_version.py`; `_print_version_stats` already calls it — only the no-flag path needs updating.

- [x] `cli/__init__.py`: `cmd_version()` (or the `elif args.command == "version"` block) — when `--stats` is absent, call `count_loc(root)` and print `f"kiso {__version__}  ({_fmt(total)} loc)"` instead of the bare version string
- [x] `cli/__init__.py`: extract `_fmt` helper (currently duplicated inside `_print_version_stats`) to module level so the plain path can reuse it
- [x] `tests/test_cli.py`: `test_version_plain_shows_loc` — capture stdout of `cmd_version(args)` with no `--stats`; assert output matches `kiso X.Y.Z  (N loc)` pattern and `N > 0`
- [x] `tests/test_cli.py`: `test_version_stats_unchanged` — existing `--stats` output still shows per-area rows and total line

---
